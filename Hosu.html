<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Down Logsheet</title>

    <!-- css file link -->
    <link rel="stylesheet" href="index.css">
</head>   
<body>
    <div class="parent">
        <div class="add-logsheet">           
        </div>   
        <div class="logsheet-table">
            <h3 class="title">エラー履歴システム</h3>
            
            <p1 id="title">入力情報</p1>
            <div class="sub-box">
                
                <div class="operatorside"style="width:50%; float:left">
                <label id="operator">依頼者</label>

                <input type="text"
                id="lotid"
                name="lotid"
                value=""
                style="width:20%"
                placeholder="ロットNo。">

                <input type="text"
                id="employeeid"
                name="employeeid"
                value=""
                style="width:20%"
                placeholder="依頼者名を入力">

                <!--Enter Error instead of selection-->
                <!--<input type="text"
                id="errorid"
                name="errorid"
                value=""
                placeholder="入力エラー内容">-->
                <!--<div id="div1"></div>-->
                
                <select style="width:20%" name="errorid" id="errorid" type="text" onchange="showfield(this.options[this.selectedIndex].value)">
                    <option value="noinput" disabled selected>エラーを選択</option>
                    <option value="電極スクラッチ">電極スクラッチ</option>
                    <option value="フィーダNG">フィーダNG</option>
                    <option value="電極崩壊">電極崩壊</option>
                    <option value="突出誤差">突出誤差</option>
                    <option value="障害">障害</option> 
                    <option value="Other">その他</option>
                      
                </select>

                <!--<a href="warningpage.html" target="popup" onclick="window.open('warningpage.html','name','width=600,height=400')"><button id="submit-button2" class="btn"onclick="firstinput()">提出する</button></a>-->
                <button id="submit-button2" class="btn" onclick="firstinput()">提出する</button>
                <div id="div1"></div>
                </div>

                <div class="maintenanceside" style="width:50%; float:right">
                <label id="maintenance">KP</label>
                <input type="text"
                id="maintenanceid"
                name="maintenanceid"
                value=""
                style="width:20%"  
                placeholder="KPを入力"
                disabled>
                        
                <input type="text"
                id="actiondone"
                name="actiondone"
                style="width:20%"  
                placeholder="是正措置"
                disabled>

                <select style="width:20%" disabled name="ackid" id="ackid" type="text">
                    <option value="" disabled selected>判定</option>
                    <option value="NOT OK">NOT OK</option>
                    <option value="OK">OK</option>
                </select>
                <button disabled id="submit-button1" class="btn" onclick="addToTable()">提出する</button><!--</a><br>-->              
                
                </div>
            </div>
            <div class="table-body2">
                <!--<label for="StatusTable" style="text-align: center;" style="width:100%">STATUS</label>-->
                <!--<p style="text-align: center;">STATUS</p>-->
                
                <table id="StatusTable" style="width=100%" border="2">
                    <caption class="captionstatus">情報</caption>
                    <thead>
                        <tr>
                            <!--<th style="width:5%">No.</th>-->
                            <th style="width:20%">ロットNo。</th> 
                            <th style="width:20%">発生日時</th>
                            <th style="width:20%">依頼者</th>
                            <th style="width:40%">エラー内容</th>  
                            <!--<th style="width:10%">KP</th>-->            
                        </tr>

                    </thead>
                    <tbody id="status">
                    </tbody>
                </table>
            </div>
            <div class="table-body">               
                <!--<label for="myTable" style="text-align: left">機器No. SW 39</label>-->
                <table id="myTable" style="width=100%" border ="2">
                    <caption class="mainstatus">機器No.<input type="text" id="machineid" name="machineid" value="" style="width:5%"> </caption>
                    <thead>
                        <tr>
                            <th style="width:5%">番号No.</th>
                            <th style="width:5%">機器No.</th>
                            <th style="width:5%">ロットNo。</th> 
                             <th style="width:10%">依頼者</th>
                            <th style="width:15%">エラー内容</th>
                            <th style="width:10%">KP</th>
                            <th style="width:15%">是正措置</th>
                            <th style="width:10%">操作可能</th>
                            <th style="width:10%">発生日時</th>
                            <th style="width:10%">終了日時</th> 
                            <th style="width:10%">合計時間 (分)</th> 
                        </tr>
                      
                    </thead>
                    <tbody id="main">

                    </tbody>
                </table>

                <h3 class="maintablefooter" id="no-data">機器のダウンタイム監視(No Data Available)</h3>
                <div class="footer">
                    
                <button id="exportToExcel" onclick="exportTableToExcel('myTable')">エクスポートデータ(.xls)</button>
                <button id="deletelocalstorage" onclick="deleteData()">clear</button>
                <button id="excel" onclick="tableToExcel()">try</button>
                <!--<button id="button5" class="btn"onclick="TestLang()">try</button>-->
                <p1 type="text" value="datenow" id="datenow"></p1>
                
                <!-- <button id="submit-button3" class="btn"onclick="save_data()">SAVE</button> -->
                <!-- <button id="submit-button4" class="btn"onclick="load_data()">LOAD</button> -->     
                </div>
            </div>      
        </div> 
    </div> 
</body> 
<script>
    
function runpy(){
    var pythonScriptPath = "test.py";
      // Run the Python script.
      subprocess.run(["python", pythonScriptPath]);
    }
</script>

<!--java script source file-->
   <!--script-->
<script type="text/javascript" src="index.js"></script>
   </html>
   <script defer src="test.py"></script>
<script type="text/javascript" src="tabletoexcel.js"></script>
</html>
<script type="text/javascript" src="datetime.js"></script>
</html>
<script type="text/javascript" src="tableborder.js"></script>
</html>


